<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Confronto Excel</title>

    <link rel="stylesheet" href="style.css" inline />

    <script src="https://cdn.jsdelivr.net/npm/exceljs/dist/exceljs.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jszip/3.10.1/jszip.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Confronta File Excel</h1>
        <div class="info-toggle">
            <button id="toggle-info">ℹ️ Come funziona</button>
            <div id="info-text" class="hidden">
                <p>
                    Questo sito consente di confrontare uno o più file Excel con un file master.<br>
                    Le celle etichettate nel master con colore D9D9D9 (grigio chiaro) verranno confrontate nei file test:
                <ul>
                    <li><span style="color:green;">Verde</span> → valore e formula identici</li>
                    <li><span style="color:orange;">Arancione</span> → valore identico ma formula diversa</li>
                    <li><span style="color:red;">Rosso</span> → valore diverso</li>
                </ul>
                È anche possibile esportare i risultati in uno ZIP, se selezionato.
                </p>
            </div>
        </div>

        <div id="file-selector-container">
            <div class="file-selector">
                <h3>Master File</h3>
                <div class="drop-area" id="drop-area-master">
                    <p id="master-text">0 file selezionati</p>
                    <input type="file" id="master-input" accept=".xlsx" />
                    <label class="button" for="master-input">Seleziona file</label>
                </div>
            </div>

            <div class="file-selector">
                <h3>Test Files</h3>
                <div class="drop-area" id="drop-area-tests">
                    <p id="tests-text">0 file selezionati</p>
                    <input type="file" id="tests-input" accept=".xlsx" multiple />
                    <label class="button" for="tests-input">Seleziona file</label>
                </div>
            </div>
        </div>

        <div class="checkbox-group">
            <input type="checkbox" id="zipOutput" />
            <label>ZIP output</label>
        </div>
        <button id="compare-button" disabled onclick="compare()">Confronta</button>
    </div>

    <script src="compator.js" inline></script>
    <script src="drag-drop-files.js" inline></script>
</body>
</html>
